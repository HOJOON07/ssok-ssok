# 리팩토링

## 리팩토링이란?

- 리팩토링은 대부분 코드가 하는 일을 파악하는 데서 시작한다.

> _좋은 코드를 가늠하는 확실한 방법은 얼마나 수정하기 쉬운가 이다._

- 건강한 코드베이스는 생산성을 극대화하고 고객에게 필요한 기능을 더 빠르고 저렴한 비용으로 제공하도록 해준다.
- 코드를 건강하게 관리하려면 프로그래밍 팀의 현재와 이상의 차이에 항상 신경 쓰면서, 이상에 가까워지도록 리팩토링해야 한다.
- 최적화, 디버깅, 방어코드 추가, 테스트하기 좋은 코드로 만드는 것과 혼동 될 수 있다.

> 남이 짠 소스 내가 고치고, 내가 짠 소스 내가 고친다.

> 올바로 작동하지 않는다고 걱정하지 마라.
> 모든 게 잘 되었다면, 내가 할 일이 없어진다.

## 리팩토링의 리듬

- 수정 가능한 작업을 잘개 쪼개기
- 수정 가능한 최소 단위를 수정하기
- 수정 후에는 컴파일
- 테스트를 작성하여 작동하는 상태 확인
- 한 사이클이 끝나면 commit (git)

## 리팩토링의 정의

- 리팩토링은 작은 단위로 작업하기 때문에 문제가 있다면 이전 단위로 돌아갈 수 있고, 작업을 중단할 수 있다.

> 누군가 "리팩토링하다가 코드가 깨져서 며칠이나 고생했다"라고 한다면 십중팔구 리팩토링한것이 아니다.

- 겉보기 동작 : 리팩토링 하기 전과 후의 코드가 똑같이 동작해야 한다. (사용자 관점에서 작업 후에 달라지는 부분이 없어야 하는 것이다.)
- **리팩토링 과정에서 발견된 버그는 리팩토링 후에도 그대로 남아 있어야 한다. ( 단, 아무도 발견하지 못한 숨은 버그는 수정해도 괜찮다.)**
- 버그를 발견하고도 지나치라니 이걸 참아 말아...?

> (참고)
> <img width="532" alt="스크린샷 2023-12-03 오전 1 36 29" src="https://github.com/HOJOON07/ssok-ssok/assets/81367886/326d2b7b-b75b-4739-8e78-d0269bc92d0d">
> (후지 제록스에서 말하는 리팩토링 기준(전제조건: 현재 운영중인, 1000만 라인 이상의 규모일때)
>
> - 위험부분 : 우선적으로 리팩토링을 수행한다.
> - 잠재적인 부분 : 일단 보류하는 부분, 전체적으로 수정이 발생시 같이 수행한다.
> - 주의해야 할 부분 : 변경 포인트를 줄일 수 있다면 문제 없음. (줄일 수 없다면 리팩토링 고려)
> - 문제 없는 부분 : 리팩토링 불필요

## 소프트웨어 개발의 목적 두 가지

1. 기능 추가

- 기능 추가 시에는 기존 코드를 건들지 않고 새 기능을 추가하기만 한다.

2. 리팩토링

- 새로운 기능은 추가하지 않고 기존 코드의 재구성에만 전념한다.
  _위 두가지 목적의 미묘한 작업 방식의 차이를 분명하게 인식해야 한다._

## 리팩토링과 클린 코드의 차이점

- (리팩토링 안에 클린코드가 포함되어있는 느낌)
- 클린 코드는 단순하게 가독성을 높이기 위한 작업이라면 리팩토링은 클린 코드를 포함하여 유지보수를 위한 코드의 개선이라고 볼 수 있다.
- 클린 코드와 같은 부분은 설계단계에서 잘 이루어져 있는 것이 중요하고, 리팩토링은 결과물이 나온 이후 수정이나 추가 작업이 진행될 때 개선해 나가도록 하자.

## 리팩토링의 장점

### 리팩토링하면 소프트웨어 설계가 좋아진다.

- 리팩토링 하지 않으면 소트프웨어의 내부 설계(아키텍쳐)가 썩기 쉽다.
- 아키텍쳐를 충분히 이해하지 못한 채 단기 목표만을 위해 코드를 수정하다 보면 기반 구조가 무너지기 쉽다.

### 리팩토링하면 소프트웨어를 이해하기 쉬워진다.

- 컴퓨터에게 시키려는 일과 이를 표현한 코드의 차이를 최대한 줄여야 한다.
- 잘 동작하지만 이상적인 구조는 아닌 코드가 있다면 잠깐 시간을 내서 리팩토링 하는 것이 바람직하다.
- 이해하기 쉬운 코드는 다른 사람을 배려하는 것과 동시에 미래의 자신에게도 이해를 용이하게 해준다.
- 기억할 필요가 있는 것들은 최대한 코드에 담으려 한다.

###리팩토링하면 버그를 쉽게 찾을 수 있다.

- 리팩토링을 통해 코드가 하는 일을 깊이 파악하게 되면서 새로 깨달은 것을 곧바로 코드에 반영하게 된다.
- 프로그램의 구조를 명확히 다듬으면 '~ 할 것이다' 하는 가정이 분명하게 드러난다.

### 리팩토링하면 프로그래밍 속도를 높일 수 있다.

- 리팩토링 => 코드 품질 향상
- 리팩토링 => 새로운 기능 추가 용이, 버그를 명확히 확인 가능, 모듈 단위 동작 파악이 용이 => 개발 속도 향상

> 아무리 뛰어난 능력을 가진 개발자라도 처음부터 완벽한 요구사항 파악, 일정 설정, 좋은 성능 확보를 동시에 하는 것은 사실상 불가능하기 때문에 리팩토링은 반드시 필요하다.
